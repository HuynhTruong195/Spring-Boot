1. ğŸŒ± Spring Boot lÃ  gÃ¬?

Spring Boot lÃ  framework Java giÃºp báº¡n:

ğŸš€ Táº¡o á»©ng dá»¥ng nhanh mÃ  khÃ´ng cáº§n cáº¥u hÃ¬nh rÆ°á»m rÃ .

ğŸ§© TÃ­ch há»£p sáºµn cÃ¡c thÆ° viá»‡n phá»• biáº¿n (web, security, JPA...).

ğŸ“¦ Cháº¡y Ä‘á»™c láº­p (Tomcat/Jetty tÃ­ch há»£p).

ğŸ“œ Convention over Configuration â€“ cÃ³ sáºµn cáº¥u hÃ¬nh há»£p lÃ½.

âŒ Giáº£m XML config, dÃ¹ng annotation + Java config.


VÃ­ dá»¥: chá»‰ vá»›i @SpringBootApplication vÃ  vÃ i dÃ²ng code lÃ  cháº¡y Ä‘Æ°á»£c server web


Má»¥c tiÃªu chÃ­nh cá»§a Spring Boot:
Giáº£m cáº¥u hÃ¬nh (Configuration): KhÃ´ng cáº§n viáº¿t quÃ¡ nhiá»u file cáº¥u hÃ¬nh XML nhÆ° trong Spring truyá»n thá»‘ng
Tá»± Ä‘á»™ng cáº¥u hÃ¬nh (Auto Configuration): Dá»±a trÃªn thÆ° viá»‡n cÃ³ trong classpath, Spring Boot sáº½ tá»± Ä‘oÃ¡n vÃ  cáº¥u hÃ¬nh cÃ¡c thÃ nh pháº§n cáº§n thiáº¿t
CÃ³ sáºµn server tÃ­ch há»£p: Spring Boot cÃ³ thá»ƒ cháº¡y trá»±c tiáº¿p á»©ng dá»¥ng mÃ  khÃ´ng cáº§n deploy vÃ o server ngoÃ i nhÆ° Tomcat
TÃ­ch há»£p dá»… dÃ ng vá»›i Spring ecosystem: Spring Boot hoáº¡t Ä‘á»™ng mÆ°á»£t mÃ  vá»›i Spring MVC, Spring Data, Spring Security, v.v



A. Cáº¥u trÃºc dá»± Ã¡n & lifecycle

ThÆ° má»¥c chuáº©n:
    src/main/java   â†’ code Java
    src/main/resources â†’ file cáº¥u hÃ¬nh (application.properties/yml)


Annotation khá»Ÿi Ä‘á»™ng:

@SpringBootApplication = @Configuration + @EnableAutoConfiguration + @ComponentScan

Main method:

    SpringApplication.run(App.class, args);

B. Controller & Request Handling (trÃ¡i tim cá»§a web app)

Annotation chÃ­nh:

    @RestController â€“ tráº£ dá»¯ liá»‡u JSON

    @Controller â€“ tráº£ vá» HTML/JSP/Thymeleaf

    @GetMapping, @PostMapping â€“ Ä‘á»‹nh nghÄ©a endpoint

    @RequestParam, @PathVariable â€“ láº¥y dá»¯ liá»‡u tá»« URL/query

    Luá»“ng xá»­ lÃ½: Request â†’ DispatcherServlet â†’ Controller â†’ Service â†’ Repository â†’ DB



C. Dependency Injection (DI)

    KhÃ¡i niá»‡m: Spring tá»± táº¡o & inject Ä‘á»‘i tÆ°á»£ng vÃ o nÆ¡i cáº§n dÃ¹ng (IoC).

    Annotation chÃ­nh:

    @Component, @Service, @Repository â€“ khai bÃ¡o Bean

    @Autowired â€“ tiÃªm Bean

    Lá»£i Ã­ch: code tÃ¡ch biá»‡t, dá»… test, dá»… má»Ÿ rá»™ng.

D. LÃ m viá»‡c vá»›i DB (Spring Data JPA)

    Entity: @Entity, @Id, @GeneratedValue

    Repository: extends JpaRepository<Entity, ID>

    Query method:

        List<User> findByName(String name);

    Cáº¥u hÃ¬nh DB trong application.properties.



 E. Cáº¥u hÃ¬nh & Profiles

application.properties / application.yml â€“ lÆ°u cáº¥u hÃ¬nh.

Profiles (application-dev.properties, application-prod.properties) â€“ Ä‘á»•i cáº¥u hÃ¬nh theo mÃ´i trÆ°á»ng.

@Value â€“ láº¥y giÃ¡ trá»‹ tá»« config.

F. Starter & Dependency Management

Starter lÃ  gÃ³i tiá»‡n Ã­ch sáºµn sÃ ng dÃ¹ng (VD: spring-boot-starter-web, spring-boot-starter-data-jpa).

Quáº£n lÃ½ dependencies qua Maven/Gradle.

G. Cháº¡y & Deploy

Cháº¡y báº±ng mvn spring-boot:run hoáº·c run class main.

ÄÃ³ng gÃ³i .jar rá»“i cháº¡y java -jar app.jar.



 
ğŸ“œğŸ“œğŸ“œğŸ“œğŸ“œğŸ“œğŸ“œğŸ“œğŸ“œğŸ“œğŸ“œğŸ“œğŸ“œğŸ“œğŸ“œ
VÃ­ dá»¥ má»™t á»©ng dá»¥ng Spring Boot Ä‘Æ¡n giáº£n:

    @SpringBootApplication
    public class MyApplication {
        public static void main (String[] args){
            SpringApplication.run(MyApplication.class, args);
        }
    }

@SpringBootApplication lÃ  má»™t annotation bao gá»“m:
@Configuration
@EnableAutoConfiguration
@ComponentScan


ğŸŒŸ Nhá»¯ng tÃ­nh nÄƒng ná»•i báº­t cá»§a Spring Boot
1. âš¡ Khá»Ÿi táº¡o nhanh & TÃ­ch há»£p sáºµn

Auto Configuration ğŸ›  â€“ Tá»± Ä‘á»™ng cáº¥u hÃ¬nh dá»±a trÃªn thÆ° viá»‡n báº¡n thÃªm vÃ o.

Starter POMs ğŸ“¦ â€“ GÃ³i tiá»‡n Ã­ch cÃ³ sáºµn (web, JPA, security, mail, batchâ€¦).

Embedded Server ğŸŒ â€“ TÃ­ch há»£p sáºµn Tomcat/Jetty/Undertow, cháº¡y app nhÆ° java -jar.

2. ğŸ“œ Giáº£m cáº¥u hÃ¬nh phá»©c táº¡p

Ãt hoáº·c khÃ´ng cáº§n XML â€“ gáº§n nhÆ° táº¥t cáº£ cáº¥u hÃ¬nh dÃ¹ng annotation & Java config.

Convention over Configuration â€“ CÃ³ cáº¥u hÃ¬nh máº·c Ä‘á»‹nh há»£p lÃ½, chá»‰ chá»‰nh khi cáº§n.

3. ğŸ”Œ Dependency Injection máº¡nh máº½

Há»— trá»£ Ä‘áº§y Ä‘á»§ DI & IoC cá»§a Spring.

TÃ­ch há»£p annotation nhÆ° @Component, @Service, @Repository, @Autowired.

4. ğŸ—„ TÃ­ch há»£p Database dá»… dÃ ng

Há»— trá»£ Spring Data JPA, JDBC, MyBatisâ€¦

Quáº£n lÃ½ káº¿t ná»‘i DB dá»… dÃ ng qua application.properties.

Cháº¡y script SQL tá»± Ä‘á»™ng khi app start.

5. âš™ï¸ Profiles & Config linh hoáº¡t

Profiles ğŸ§© â€“ TÃ¡ch cáº¥u hÃ¬nh theo mÃ´i trÆ°á»ng (dev/test/prod).

Há»— trá»£ application.properties & application.yml.

Externalized Configuration â€“ dá»… Ä‘á»•i config mÃ  khÃ´ng cáº§n build láº¡i app.

6. ğŸ“Š Actuator â€“ GiÃ¡m sÃ¡t & Quáº£n lÃ½

Spring Boot Actuator ğŸ“ˆ â€“ Cung cáº¥p endpoint Ä‘á»ƒ theo dÃµi sá»©c khá»e á»©ng dá»¥ng, metrics, logsâ€¦

Dá»… tÃ­ch há»£p vá»›i Prometheus, Grafana.

7. ğŸ§ª Testing tiá»‡n lá»£i

Há»— trá»£ JUnit, Mockito, Spring Test.

CÃ³ annotation nhÆ° @SpringBootTest Ä‘á»ƒ test toÃ n bá»™ app.

8. ğŸš€ Deploy Ä‘a dáº¡ng

Build thÃ nh .jar hoáº·c .war.

Deploy Ä‘Æ°á»£c trÃªn má»i ná»n táº£ng (server váº­t lÃ½, cloud, container nhÆ° Docker/Kubernetes).



Tá»± Ä‘á»™ng cáº¥u hÃ¬nh (Auto Configuration)
Spring Boot tá»± Ä‘á»™ng cáº¥u hÃ¬nh cÃ¡c thÃ nh pháº§n cá»§a á»©ng dá»¥ng dá»±a trÃªn thÆ° viá»‡n cÃ³ trong classpath vÃ  cáº¥u hÃ¬nh máº·c Ä‘á»‹nh há»£p lÃ½
VÃ­ dá»¥:
Náº¿u báº¡n thÃªm spring-boot-starter-web, Spring Boot sáº½ tá»± Ä‘á»™ng cáº¥u hÃ¬nh Spring MVC vÃ  Tomcat
Náº¿u cÃ³ spring-boot-starter-data-jpa, Spring Boot sáº½ cáº¥u hÃ¬nh JPA vÃ  káº¿t ná»‘i cÆ¡ sá»Ÿ dá»¯ liá»‡u



Starter Dependencies
Spring Boot cung cáº¥p cÃ¡c gÃ³i starter Ä‘á»ƒ gom nhÃ³m cÃ¡c thÆ° viá»‡n thÆ°á»ng dÃ¹ng láº¡i vá»›i nhau, vÃ­ dá»¥:
 

Starter             	              Chá»©c nÄƒng
spring-boot-starter-web          PhÃ¡t triá»ƒn web REST/API vá»›i Spring MVC
spring-boot-starter-data-jpa       LÃ m viá»‡c vá»›i JPA vÃ  Hibernate
spring-boot-starter-security        Báº£o máº­t á»©ng dá»¥ng
spring-boot-starter-test            Viáº¿t test Ä‘Æ¡n vá»‹, mock, integration test


TÃ­ch há»£p server nhÃºng
    Spring Boot há»— trá»£ server nhÃºng (embedded) nhÆ°:
    Tomcat (máº·c Ä‘á»‹nh)
    Jetty
    Undertow
 

Spring Boot Actuator
Spring Boot Actuator cung cáº¥p nhiá»u endpoint tiá»‡n Ã­ch Ä‘á»ƒ giÃ¡m sÃ¡t vÃ  kiá»ƒm tra tÃ¬nh tráº¡ng há»‡ thá»‘ng:

Endpoint            Chá»©c nÄƒng
/actuator/health    Kiá»ƒm tra tráº¡ng thÃ¡i há»‡ thá»‘ng
/actuator/metrics   Xem thÃ´ng tin vá» CPU, RAM, request
/actuator/env       Xem cÃ¡c biáº¿n mÃ´i trÆ°á»ng vÃ  cáº¥u hÃ¬nh
/actuator/loggers   Theo dÃµi cáº¥u hÃ¬nh log hiá»‡n táº¡i      

 

Há»— trá»£ cáº¥u hÃ¬nh linh hoáº¡t
    Spring Boot há»— trá»£ 2 Ä‘á»‹nh dáº¡ng cáº¥u hÃ¬nh:
    application.properties
    application.yml
    NgoÃ i ra, há»— trá»£ nhiá»u profile mÃ´i trÆ°á»ng (dev, test, prod) giÃºp tÃ¹y biáº¿n cáº¥u hÃ¬nh cho tá»«ng mÃ´i trÆ°á»ng cháº¡y
    

TÃ­ch há»£p cÃ´ng cá»¥ test máº¡nh máº½
    Spring Boot tÃ­ch há»£p sáºµn cÃ¡c cÃ´ng cá»¥ test nhÆ°:
    JUnit
    Mockito
    Spring Test
    TestRestTemplate (test REST API)
    @SpringBootTest (cháº¡y context Ä‘áº§y Ä‘á»§)
    GiÃºp viáº¿t test dá»… hÆ¡n, nhanh hÆ¡n vÃ  Ä‘Ã¡ng tin cáº­y hÆ¡n


Spring Initializr â€“ Táº¡o project siÃªu nhanh
    Spring Boot cung cáº¥p website https://start.spring.io Ä‘á»ƒ:
    Chá»n phiÃªn báº£n Spring Boot
    Chá»n cÃ¡c starter cáº§n thiáº¿t
    Táº¡o project vÃ  táº£i vá» file ZIP
    Cá»±c ká»³ tiá»‡n lá»£i Ä‘á»ƒ khá»Ÿi Ä‘áº§u dá»± Ã¡n má»›i


Dá»… má»Ÿ rá»™ng â€“ phÃ¹ há»£p Microservices
    Spring Boot Ä‘Æ°á»£c thiáº¿t káº¿ sáºµn Ä‘á»ƒ:
    TÆ°Æ¡ng thÃ­ch vá»›i kiáº¿n trÃºc Microservices
    Há»— trá»£ Docker, cloud (Heroku, AWS, GCP)
    Dá»… tÃ­ch há»£p vá»›i Spring Cloud, Kafka, RabbitMQ...    
  
    

ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾    
 CÃC DEPEDENCE TRONG SPRINGBOOT

 ğŸŒ Spring Web

    Dependency: spring-boot-starter-web

    DÃ¹ng cho: XÃ¢y dá»±ng á»©ng dá»¥ng web, REST API.

    Bao gá»“m: Spring MVC, Tomcat (máº·c Ä‘á»‹nh), Jackson (JSON).

    VÃ­ dá»¥: @RestController, @GetMapping, @PostMapping.

ğŸ—„ Spring Data JPA

    Dependency: spring-boot-starter-data-jpa

    DÃ¹ng cho: Káº¿t ná»‘i cÆ¡ sá»Ÿ dá»¯ liá»‡u, ORM vá»›i Hibernate.

    Bao gá»“m: Hibernate, JPA API.

    VÃ­ dá»¥: @Entity, @Repository, findAll(), save().

ğŸ’¾ Database Driver

    VÃ­ dá»¥: mysql-connector-java (MySQL), postgresql (PostgreSQL).

    DÃ¹ng cho: Cho phÃ©p Spring Boot káº¿t ná»‘i trá»±c tiáº¿p Ä‘áº¿n cÆ¡ sá»Ÿ dá»¯ liá»‡u tÆ°Æ¡ng á»©ng.

ğŸ” Spring Security

    Dependency: spring-boot-starter-security

    DÃ¹ng cho: Quáº£n lÃ½ xÃ¡c thá»±c (authentication) vÃ  phÃ¢n quyá»n (authorization).

    VÃ­ dá»¥: @EnableWebSecurity, cáº¥u hÃ¬nh UserDetailsService.

ğŸ“ Spring Boot DevTools

    Dependency: spring-boot-devtools

    DÃ¹ng cho: Há»— trá»£ phÃ¡t triá»ƒn nhanh: tá»± Ä‘á»™ng reload khi thay Ä‘á»•i code.

ğŸ“¦ Spring Boot Starter Test

    Dependency: spring-boot-starter-test

    DÃ¹ng cho: Viáº¿t unit test vÃ  integration test.

    Bao gá»“m: JUnit, Mockito, Spring Test.



spring-boot-starter-web

    XÃ¢y dá»±ng á»©ng dá»¥ng web RESTful vá»›i Spring MVC

spring-boot-starter-data-jpa

    Káº¿t ná»‘i CSDL vÃ  thao tÃ¡c ORM vá»›i JPA + Hibernate

spring-boot-starter-security

    Cung cáº¥p báº£o máº­t (xÃ¡c thá»±c, phÃ¢n quyá»n)

spring-boot-starter-thymeleaf

    Sá»­ dá»¥ng Thymeleaf Ä‘á»ƒ táº¡o giao diá»‡n HTML

spring-boot-starter-test

    Viáº¿t unit test vÃ  integration test (JUnit, Mockito, AssertJ)

spring-boot-starter-validation

    Há»— trá»£ validation (JSR-380) cho dá»¯ liá»‡u Ä‘áº§u vÃ o

spring-boot-starter-mail

    Gá»­i email tá»« á»©ng dá»¥ng

spring-boot-starter-actuator

    GiÃ¡m sÃ¡t há»‡ thá»‘ng, kiá»ƒm tra health, metrics, logs

 

Quáº£n lÃ½ dependency báº±ng Maven/Gradle
Vá»›i Maven:
    Báº¡n khai bÃ¡o dependencies trong file pom.xml
Maven sáº½ tá»± Ä‘á»™ng táº£i cÃ¡c thÆ° viá»‡n liÃªn quan vá» project cá»§a báº¡n
Vá»›i Gradle:
    TÆ°Æ¡ng tá»±, nhÆ°ng khai bÃ¡o trong file build.gradle    






ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ğŸ’¾ 

    Spring Data JPA

ğŸ”‘ Äiá»ƒm chÃ­nh:
 Spring Data JPA lÃ  má»™t module trong há»‡ sinh thÃ¡i Spring Data, Ä‘Æ°á»£c xÃ¢y dá»±ng trÃªn ná»n JPA (Java Persistence API), giÃºp Ä‘Æ¡n giáº£n hÃ³a cÃ¡c thao tÃ¡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u
NÃ³ khÃ´ng thay tháº¿ JPA, mÃ  cung cáº¥p thÃªm táº§ng trá»«u tÆ°á»£ng cao hÆ¡n Ä‘á»ƒ giáº£m code boilerplate vÃ  tÄƒng tá»‘c phÃ¡t triá»ƒn


âœ… CÃ¡c thÃ nh pháº§n liÃªn quan
 JPA (chuáº©n Java)
    API chuáº©n Ä‘á»ƒ quáº£n lÃ½ entity vÃ  Ã¡nh xáº¡ object â†” table
Hibernate
    Má»™t trong nhá»¯ng triá»ƒn khai phá»• biáº¿n nháº¥t cá»§a JPA
Spring Data JPA
    Há»— trá»£ tÆ°Æ¡ng tÃ¡c vá»›i JPA dá»… dÃ ng hÆ¡n qua Repository

âœ… Lá»£i Ã­ch cá»§a Spring Data JPA
    KhÃ´ng cáº§n viáº¿t SQL cho cÃ¡c truy váº¥n Ä‘Æ¡n giáº£n
    Tá»± sinh cÃ¡c hÃ m nhÆ° save(), findById(), findAll()
    Há»— trá»£ phÃ¢n trang, sáº¯p xáº¿p, query Ä‘á»™ng
    TÃ­ch há»£p dá»… dÃ ng vá»›i Spring Boot

ğŸ’¡ VÃ­ dá»¥:

@Entity
public class User{
    @Id
    @GeneratedValue
    private Long id;
    
    private String username;
    private String email;
}
#Repository
    public interface UserRepository extends JpaRepository<User, Long> {
        List<User> findByName(String name);
    }
ğŸ‘‰ Chá»‰ cáº§n káº¿ thá»«a JpaRepository, báº¡n Ä‘Ã£ cÃ³ sáºµn Ä‘áº§y Ä‘á»§ cÃ¡c phÆ°Æ¡ng thá»©c CRUD


âœ… CÃ¡c interface quan trá»ng
CrudRepository<T, ID>
    CÃ¡c hÃ m cÆ¡ báº£n: save, findById, delete

PagingAndSortingRepository<T, ID>
    Há»— trá»£ thÃªm phÃ¢n trang vÃ  sáº¯p xáº¿p

JpaRepository<T, ID>
    Má»Ÿ rá»™ng cáº£ hai interface trÃªn + thÃªm cÃ¡c hÃ m tiá»‡n Ã­ch khÃ¡c

JpaSpecificationExecutor<T>
    Há»— trá»£ viáº¿t query Ä‘á»™ng theo Ä‘iá»u kiá»‡n (Specification)

âš™ï¸ CÆ¡ cháº¿ sinh truy váº¥n tá»± Ä‘á»™ng
Khi báº¡n viáº¿t má»™t method trong Repository, Spring sáº½ Ä‘á»c tÃªn method rá»“i dá»‹ch sang query SQL/JPQL.
VÃ­ dá»¥:
    List<User> findByName(String name);
Spring sáº½ tá»± hiá»ƒu lÃ : SELECT u FROM User u WHERE u.name = :name

âœ…Quy táº¯c Ä‘áº·t tÃªn (Method Name Keywords)
Má»™t sá»‘ tá»« khÃ³a Ä‘áº·c biá»‡t trong tÃªn method sáº½ Ä‘Æ°á»£c Spring hiá»ƒu Ä‘á»ƒ sinh query:

    findBy, readBy, getBy â†’ tÃ¬m kiáº¿m

    And, Or â†’ ná»‘i nhiá»u Ä‘iá»u kiá»‡n

    Between, LessThan, GreaterThan â†’ so sÃ¡nh

    Like, Containing, StartingWith, EndingWith â†’ tÃ¬m kiáº¿m theo máº«u

    OrderBy â†’ sáº¯p xáº¿p

ğŸ‘‰ VÃ­ dá»¥:    

    // Repository káº¿ thá»«a JpaRepository
public interface UserRepository extends JpaRepository<User, Long> {

    // Spring sáº½ tá»± sinh ra query: SELECT u FROM User u WHERE u.age > :age
    List<User> findByAgeGreaterThan(int age);

    // SELECT u FROM User u WHERE u.name LIKE %:keyword%
    List<User> findByNameContaining(String keyword);

    // SELECT u FROM User u WHERE u.name = :name OR u.email = :email
    List<User> findByNameOrEmail(String name, String email);
}

        
âœ…Custom query khi cáº§n:
Náº¿u tÃªn method khÃ´ng Ä‘Ã¡p á»©ng Ä‘á»§, báº¡n cÃ³ thá»ƒ:
DÃ¹ng annotation @Query (JPQL hoáº·c native SQL).
    @Query("SELECT u FROM User u WHERE u.email = ?1")
    User findByEmail(String email);


ğŸ“ CÃ¡c cÃ¡ch viáº¿t truy váº¥n trong Spring Data JPA    

Method Name Query â†’ Ã­t code, chá»‰ cáº§n Ä‘áº·t tÃªn Ä‘Ãºng quy táº¯c.

@Query â†’ viáº¿t tay khi query phá»©c táº¡p.

Specification â†’ dÃ¹ng khi filter nhiá»u Ä‘iá»u kiá»‡n, build query Ä‘á»™ng.

Projection â†’ tá»‘i Æ°u khi khÃ´ng cáº§n toÃ n bá»™ dá»¯ liá»‡u entity.

ğŸ‘‰@Query (JPQL hoáº·c Native SQL)
public interface UserRepository extends JpaRepository<User, Long> {

    // JPQL (sá»­ dá»¥ng tÃªn entity vÃ  field, khÃ´ng pháº£i tÃªn báº£ng/column DB)
    @Query("SELECT u FROM User u WHERE u.email = :email")
    User findByEmailJPQL(@Param("email") String email);

    // Native SQL (viáº¿t Ä‘Ãºng theo tÃªn báº£ng vÃ  cá»™t trong DB)
    @Query(value = "SELECT * FROM users WHERE email = :email", nativeQuery = true)
    User findByEmailNative(@Param("email") String email);
}

. Specification (truy váº¥n Ä‘á»™ng theo Ä‘iá»u kiá»‡n)
// Táº¡o class chá»©a cÃ¡c Ä‘iá»u kiá»‡n query Ä‘á»™ng
public class UserSpecifications {

    // Äiá»u kiá»‡n: tÃªn báº±ng name
    public static Specification<User> hasName(String name) {
        // root: Ä‘áº¡i diá»‡n cho entity User
        // query: cÃ¢u query tá»•ng thá»ƒ
        // cb: CriteriaBuilder Ä‘á»ƒ build Ä‘iá»u kiá»‡n
        return (root, query, cb) -> cb.equal(root.get("name"), name);
    }

    // Äiá»u kiá»‡n: tuá»•i lá»›n hÆ¡n age
    public static Specification<User> ageGreaterThan(int age) {
        return (root, query, cb) -> cb.greaterThan(root.get("age"), age);
    }
}

// Sá»­ dá»¥ng trong Repository
public interface UserRepository extends JpaRepository<User, Long>, JpaSpecificationExecutor<User> {
}

// Gá»i trong Service
List<User> results = userRepository.findAll(
    Specification.where(UserSpecifications.hasName("Nam"))
                 .and(UserSpecifications.ageGreaterThan(20))
);


ğŸ‘‰. Projection (tráº£ vá» má»™t pháº§n dá»¯ liá»‡u)

// Interface projection: chá»‰ láº¥y ra 2 field (id vÃ  name)
public interface UserSummary {
    Long getId();   // láº¥y id
    String getName(); // láº¥y name
}

public interface UserRepository extends JpaRepository<User, Long> {

    // Spring sáº½ chá»‰ map dá»¯ liá»‡u vÃ o UserSummary, khÃ´ng láº¥y toÃ n bá»™ entity User
    List<UserSummary> findBy();
}

// Gá»i ra chá»‰ nháº­n Ä‘Æ°á»£c dá»¯ liá»‡u gá»n nháº¹ hÆ¡n
for(UserSummary u : userRepository.findBy()) {
    System.out.println(u.getId() + " - " + u.getName());
}



ğŸ“ŒToÃ¡n tá»­ ná»‘i Ä‘iá»u kiá»‡n



And

   ğŸ‘‰ AND logic

Or

   ğŸ‘‰ OR logic

Between

   ğŸ‘‰ Trong khoáº£ng

LessThan / GreaterThan

   ğŸ‘‰ Nhá» hÆ¡n / Lá»›n hÆ¡n

Like / Containing

   ğŸ‘‰ Giá»‘ng chuá»—i / chá»©a chuá»—i

IsNull / IsNotNull

   ğŸ‘‰ Kiá»ƒm tra NULL hoáº·c khÃ´ng NULL

In

    ğŸ‘‰Tá»“n táº¡i trong danh sÃ¡ch

List<User> findByAgeGreaterThanAndStatus(Integer age, String status);
List<User> findyEmailContaining(String keyword);



ğŸ“ŒSáº¯p xáº¿p vÃ  phÃ¢n trang

    Spring Data JPA há»— trá»£ Sort vÃ  Pageable:
 List<User> findByStatus(String status, Sort sort);
 Page<User> findByRole(String role, Pageable pageable);



ğŸ“ŒMá»™t sá»‘ vÃ­ dá»¥ thá»±c táº¿

List<Product> findByPriceBetween(BigDecimal min, BigDecimal max);
List<User> findByEmailLike(String emailPattern);
Optional<User> findByUsernameAndPassword(String username, String password);


ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ 

Custom Query vá»›i @Query

ğŸ”¹ 1. @Query vá»›i JPQL (Java Persistence Query Language)

    JPQL dÃ¹ng tÃªn entity vÃ  field trong class Java (khÃ´ng pháº£i tÃªn báº£ng/column trong DB).
    GiÃºp viáº¿t query Ä‘á»™c láº­p vá»›i loáº¡i DB.

public interface UserRepository extends JpaRepository<User, Long> {

    // Láº¥y user theo email (dÃ¹ng JPQL)
    @Query("SELECT u FROM User u WHERE u.email = :email")
    User findByEmail(@Param("email") String email);

    // Láº¥y user theo tÃªn gáº§n Ä‘Ãºng (LIKE)
    @Query("SELECT u FROM User u WHERE u.name LIKE %:name%")
    List<User> searchByName(@Param("name") String name);

    // Láº¥y user theo tuá»•i > ?1 (tham sá»‘ theo vá»‹ trÃ­)
    @Query("SELECT u FROM User u WHERE u.age > ?1")
    List<User> findOlderThan(int age);
}


ğŸ”¹ 2. @Query vá»›i Native SQL

    DÃ¹ng khi muá»‘n viáº¿t SQL thuáº§n theo Ä‘Ãºng tÃªn báº£ng/cá»™t trong DB.
    PhÃ¹ há»£p cho query phá»©c táº¡p, join nhiá»u báº£ng.

public interface UserRepository extends JpaRepository<User, Long> {

    // Native SQL: Láº¥y user theo email
    @Query(value = "SELECT * FROM users WHERE email = :email", nativeQuery = true)
    User findByEmailNative(@Param("email") String email);

    // Native SQL: Láº¥y táº¥t cáº£ user cÃ³ tuá»•i trong khoáº£ng
    @Query(value = "SELECT * FROM users WHERE age BETWEEN :min AND :max", nativeQuery = true)
    List<User> findUsersBetweenAges(@Param("min") int min, @Param("max") int max);
}


ğŸ”¹ 3. @Query vá»›i Update/Delete

    Khi muá»‘n cáº­p nháº­t hoáº·c xÃ³a dá»¯ liá»‡u, cáº§n dÃ¹ng @Modifying vÃ  @Transactional.

public interface UserRepository extends JpaRepository<User, Long> {

    // Cáº­p nháº­t tÃªn user theo id
    @Modifying
    @Transactional
    @Query("UPDATE User u SET u.name = :name WHERE u.id = :id")
    int updateUserName(@Param("id") Long id, @Param("name") String name);

    // XÃ³a user theo email
    @Modifying
    @Transactional
    @Query("DELETE FROM User u WHERE u.email = :email")
    int deleteByEmail(@Param("email") String email);

    //tÃ¬m kiáº¿m theo email
    @Query("SELECT Count(u)>0 FROM User u WHERE u.email= :email")
    Boolean existByEmail(@Param("mail") String mail)
    -> tráº£ vá» true or false 
    . náº¿u lá»›n hÆ¡n 0 tá»©c tá»“n táº¡i-> true

    CÃ“ THá»‚ DÃ™NG THAM Sá» ?1, ?2

    @Query("SELECT COUNT(u) > 0 FROM User u WHERE u.email = ?1")
    Boolean existsByEmail(String email);

}


ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ 
Paging vÃ  Sorting trong Spring Data JPA

1ï¸âƒ£ Paging (PhÃ¢n trang)

Trong Spring Data JPA, báº¡n cÃ³ thá»ƒ truyá»n vÃ o tham sá»‘ kiá»ƒu Pageable Ä‘á»ƒ láº¥y dá»¯ liá»‡u theo trang.

VÃ­ dá»¥:
    public interface UserRepository extends JpaRepository<User, Long> {

        // Tráº£ vá» Page<User> thay vÃ¬ List<User>
        Page<User> findByAgeGreaterThan(int age, Pageable pageable);
    }


Sá»­ dá»¥ng trong Service/Controller:
   // Page sá»‘ 0 (trang Ä‘áº§u), size = 5 tá»©c cÃ³ 5 pháº§n tá»­ 1 trang
Pageable pageable = PageRequest.of(0, 5);

// Gá»i repo -> tráº£ vá» 5 User cÃ³ age > 18
Page<User> page = userRepository.findByAgeGreaterThan(18, pageable);

// Láº¥y dá»¯ liá»‡u
List<User> users = page.getContent();   ->danh sÃ¡ch dá»¯ liá»‡u
int totalPages = page.getTotalPages();  -> Tá»•ng sá»‘ trang
long totalElements = page.getTotalElements(); -> Tá»•ng sá»‘ pháº§n tá»­
boolean hasNext = page.hasNext();       -> CÃ²n trang sau hay khÃ´ng

ğŸ‘‰ Pageable sáº½ tá»± Ä‘á»™ng sinh ra SQL cÃ³ LIMIT vÃ  OFFSET.


2ï¸âƒ£ Sorting (Sáº¯p xáº¿p)

CÃ³ thá»ƒ sáº¯p xáº¿p báº±ng Sort hoáº·c káº¿t há»£p trong Pageable.

VÃ­ dá»¥ Sort riÃªng:
// Sáº¯p xáº¿p theo tÃªn tÄƒng dáº§n
List<User> users = userRepository.findAll(Sort.by("name"));

// Sáº¯p xáº¿p theo tuá»•i giáº£m dáº§n
List<User> users = userRepository.findAll(Sort.by(Sort.Direction.DESC, "age"));



3ï¸âƒ£ Káº¿t há»£p Paging + Sorting

// Page sá»‘ 0, size = 10, sáº¯p xáº¿p theo tuá»•i giáº£m dáº§n
Pageable pageable = PageRequest.of(0, 10, Sort.by(Sort.Direction.DESC, "age"));

Page<User> page = userRepository.findAll(pageable);

ğŸ‘‰ SQL sinh ra (vÃ­ dá»¥ MySQL): 
SELECT * FROM users ORDER BY age DESC LIMIT 10 OFFSET 0;



4ï¸âƒ£ Khi nÃ o dÃ¹ng Page vs Slice

Page<T>: cÃ³ Ä‘áº§y Ä‘á»§ info (total elements, total pages, sá»‘ trang hiá»‡n táº¡i, â€¦) â†’ dÃ¹ng khi báº¡n cáº§n hiá»ƒn thá»‹ phÃ¢n trang chuáº©n (vÃ­ dá»¥ web show tá»•ng sá»‘ trang).

Slice<T>: chá»‰ biáº¿t cÃ³ cÃ²n trang tiáº¿p theo hay khÃ´ng (hasNext()) â†’ nháº¹ hÆ¡n, dÃ¹ng khi chá»‰ cáº§n load-more (infinite scroll).



ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ 
DTO Projection vÃ  Interface-based Projection

1ï¸âƒ£ DTO Projection (Class-based Projection)
Khi báº¡n chá»‰ cáº§n má»™t pháº§n dá»¯ liá»‡u cá»§a Entity (vÃ­ dá»¥: chá»‰ cáº§n name vÃ  email thay vÃ¬ toÃ n bá»™ User), báº¡n khÃ´ng nÃªn táº£i toÃ n bá»™ entity. LÃºc nÃ y, dÃ¹ng Projection giÃºp:
    Truy váº¥n nhanh hÆ¡n
    TrÃ¡nh láº¥y dá»¯ liá»‡u dÆ° thá»«a
    Dá»… map sang JSON hoáº·c dá»¯ liá»‡u tráº£ vá» API

// DTO
public class UserDTO {
    private String name;
    private String email;

    public UserDTO(String name, String email) {  // constructor cáº§n thiáº¿t
        this.name = name;
        this.email = email;
    }

    // getter vÃ  setter
}

// Repository
public interface UserRepository extends JpaRepository<User, Long> {

    @Query("SELECT new com.example.demo.UserDTO(u.name, u.email) FROM User u WHERE u.active = true")
    List<UserDTO> findActiveUsers();
}

Giáº£i thÃ­ch:

new com.example.demo.UserDTO(u.name, u.email) â†’ Spring sáº½ gá»i constructor cá»§a DTO.

Chá»‰ láº¥y name vÃ  email, khÃ´ng load toÃ n bá»™ entity â†’ tiáº¿t kiá»‡m tÃ i nguyÃªn.

Há»— trá»£ tÃ­nh nÄƒng máº¡nh máº½ cá»§a class (constructor, method, validation...).


2ï¸âƒ£ Interface-based Projection
Sá»­ dá»¥ng interface Ä‘á»ƒ â€œmapâ€ dá»¯ liá»‡u tá»« query trá»±c tiáº¿p vÃ o cÃ¡c getter method.
Spring Data JPA tá»± táº¡o implementation runtime, khÃ´ng cáº§n DTO class thá»±c sá»±.
PhÃ¹ há»£p vá»›i query Ä‘Æ¡n giáº£n, khÃ´ng cáº§n logic trong DTO.

VÃ­ dá»¥:
    // Projection interface
    public interface UserNameEmail {
        String getName();
        String getEmail();
    }

    // Repository
    public interface UserRepository extends JpaRepository<User, Long> {

        List<UserNameEmail> findByActiveTrue();
    }

    LÆ¯U Ã: TÃªn getter pháº£i trÃ¹ng vá»›i tÃªn field trong Entity.

    Giáº£i thÃ­ch:

Spring tá»± generate class áº©n implementing UserNameEmail.

Khi query findByActiveTrue() â†’ tráº£ vá» list cÃ¡c object cÃ³ getName() vÃ  getEmail().

KhÃ´ng cáº§n constructor, khÃ´ng cáº§n DTO class thá»±c sá»±.
